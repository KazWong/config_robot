<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro" name="mpo_500">
  <!-- Macro for calculating inertia of cylinder -->
  <xacro:macro name="cylinder_inertia" params="m r h">
    <inertia  ixx="${m*(3*r*r+h*h)/12}" ixy = "0" ixz = "0"
              iyy="${m*(3*r*r+h*h)/12}" iyz = "0"
              izz="${m*r*r/2}" /> 
  </xacro:macro>

  <xacro:macro name="omni_wheel_250" params="name parent *origin *fdir1">
    <joint name="${name}_joint" type="continuous">
      <xacro:insert_block name="origin" />
      <parent link="${parent}" />
      <child link="${name}_link" />
      <axis xyz="0 0 1" rpy="0 0"/>
      <!-- <calibraion rising="0.0" falling="0.0"> -->
      <dynamics damping="0.001" friction="1.0"/>
      <limit effort="1000000.0" velocity="10000.0"/>
     </joint>
   <gazebo reference="${name}_joint">
     <stopCfm>0.0001</stopCfm>
     <stopErp>0.8</stopErp>
     <provideFeedback>true</provideFeedback>
     <implicitSpringDamper>true</implicitSpringDamper>
     <!-- <fudgeFactor></fudgeFactor>  -->
   </gazebo>
   <!-- SDF -->
  <gazebo reference="${name}_joint">
    <gearbox_ratio>32.0</gearbox_ratio>
  </gazebo>


  <link name="${name}_link" type="wheel">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <!-- <mesh filename="package://description/meshes/MPO-500-WHEEL.STL"/> -->
        <cylinder radius="0.12" length="0.1"/>
      </geometry>
      <material name="Black" />
    </visual>

    <inertial>
      <mass value="1.0" />
      <origin xyz="0 0 0" rpy="0 0 0" />
      <cylinder_inertia  m="2.5" r="0.12" h="0.1" />
    </inertial>
    
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <cylinder radius="0.12" length="0.1"/>
      </geometry>
    </collision>
  </link>
  <gazebo reference="${name}_link">
    <material>Gazebo/Black</material>
    <gravity>true</gravity>
    <selfCollide>false</selfCollide>
    <maxVel>10000.0</maxVel>
    <!--<dampingFactor>1.0</dampingFactor>
    <minDepth>0.01</minDepth>
    <xacro:insert_block name="fdir1"/>
    <mu1>0.0</mu1>
    <mu2>0.0</mu2>-->
    <kp>0.0</kp>
    <kd>0.0</kd>
    <!--<maxContacts></maxContacts>
    <laserRetro></laserRetro>-->
  </gazebo>
  <!-- SDF -->
  <gazebo reference="${name}_link">
    <collision>
      <surface>
        <friction>
          <torsional>
            <coefficient>1.0</coefficient>
          </torsional>
          <ode>
            <mu1>0</mu1>
            <mu2>0.5</mu2>
            <xacro:insert_block name="fdir1"/>
            <slip1>0</slip1>
            <slip2>0</slip2>
          </ode>
        </friction>
      </surface>
    </collision>
  </gazebo>
    
  <transmission name="${name}_joint_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="${name}_joint">
      <hardwareInterface>VelocityJointInterface</hardwareInterface>
    </joint>
    <actuator name="${name}_joint_motor">
      <!-- Deprecated syntax <hardwareInterface>VelocityJointInterface</hardwareInterface> -->
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>

  </xacro:macro>
  
</robot>


